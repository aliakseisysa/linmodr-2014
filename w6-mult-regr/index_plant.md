---
title: "Введение в регрессионный анализ: множественная регрессия"
author: "Вадим Хайтов, Марина Варфоломеева"
highlighter: highlight.js
output: html_document
job: Каф. Зоологии беспозвоночных, СПбГУ
mode: standalone
hitheme: idea
subtitle: Линейные модели на R, осень 2014
framework: io2012
widgets: mathjax

---

## Мы рассмотрим

+ Технику подгонки множественных регрессионных моделей
+ Технику валидизации множественных регрессионных моделей

### Вы сможете

+ Подобрать множественную линейную модель
+ Протестировать ее состоятельность и валидность
+ Дать трактовку результатам 



--- .segue

# Рабочий пример: Какие факторы определяют распределение функциональных групп растений?

--- &twocol

*** =left
<img src="figure/USA data points.png" width="400" height="300" >   

(Пример взят из книги Quinn&Keugh,2002; Оригинальная работа: Paruelo & Lauenroth, 1996)

Считается, что распределение C3 растений регулируется только температуой той местности, где они произрастают.
Проверяется гипотеза о связи распределения C3 растений не только со среднегодовой температурой,  но и с уровнем осадков

*** =right

Зависимая перменная   
------------------
`С3` - отностельное обилие травянистых растений, демонстрирующих $C_3$ путь фотосинтеза

Предикторы  
------------------
`LAT` - штрота  
`LONG` - долгота  
`MAP` -  среднегодовое количество осадков (мм)  
`MAT` - среднегодвая температура (градусы)   
`JJAMAP` - доля осадков, выпадающих в летние месяцы   
`DJFMAP` - доля осадкв, выпадающих в зимние месяцы   

---

## Читаем данные


```r
plant <- read.csv("paruelo.csv")
plant <- plant[,-2]
head(plant)
```

```
##     C3 MAP  MAT JJAMAP DJFMAP   LONG   LAT
## 1 0.65 199 12.4   0.12   0.45 119.55 46.40
## 2 0.65 469  7.5   0.24   0.29 114.27 47.32
## 3 0.76 536  7.2   0.24   0.20 110.78 45.78
## 4 0.75 476  8.2   0.35   0.15 101.87 43.95
## 5 0.33 484  4.8   0.40   0.14 102.82 46.90
## 6 0.03 623 12.0   0.40   0.11  99.38 38.87
```


---

## Можно ли ответить на вопрос таким методом?


```r
cor(plant)
```

```
##              C3      MAP       MAT   JJAMAP    DJFMAP     LONG      LAT
## C3      1.00000 -0.06242 -0.511388  0.02301 -0.069231  0.04153  0.66698
## MAP    -0.06242  1.00000  0.355091  0.11226 -0.404512 -0.73369 -0.24651
## MAT    -0.51139  0.35509  1.000000 -0.08077  0.001478 -0.21311 -0.83859
## JJAMAP  0.02301  0.11226 -0.080771  1.00000 -0.791540 -0.49156  0.07417
## DJFMAP -0.06923 -0.40451  0.001478 -0.79154  1.000000  0.77074 -0.06512
## LONG    0.04153 -0.73369 -0.213109 -0.49156  0.770744  1.00000  0.09655
## LAT     0.66698 -0.24651 -0.838590  0.07417 -0.065125  0.09655  1.00000
```

---

### Проблема 1. Взаимосвязь между переменными может находиться под контролем других переменых (частная корреляция).    
### Пробема 2. Множественные сравнения.   
<br>
<br>

### Необходимо учесть все взаимовлияния в одном анализе



---

## Нам предстоит построить множественную регрессионную модель
<br>
$$y_i = \beta_0 + \beta_1x_{i,1} + \beta_2x_{i,2} + \beta_3x_{i,3} + ... + \beta_px_{i,p} + \epsilon_i$$

<br>

$y_i$ - значение зависимой переменной $Y$ при значении предикторов $X_1 = x_{i,1}$, $X_2 = x_{i,2}$ и т.д.   

$\beta_0$ - свободный член (_intercept_). Значение $Y$ при $X_1=X_2=X_3=....=X_p=0$  
$\beta_1$ - _частный_ угловой коэффициент для зависимости $Y$ от $X_1$. Показывает насколько единиц изменяется $Y$ при изменении $X_1$ на одну единицу, при условии, что все остальные предикторы не изменяются.   
$\beta_2$, $\beta_3$, ...., $\beta_p$ - аналогично   

$\epsilon_i$ - варьирование $Y$, не объясняемое данной моделью. 

---

## Геометрически,  это плоскость в многомерном пространстве











































